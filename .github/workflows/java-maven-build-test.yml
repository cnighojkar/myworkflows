name: Build and Scan Workflow

on:
  workflow_call:
    inputs:   
      java-version:
        required: false
        type: string
        default: '11'
      version:
        type: string
        default: '0.3.0'
      app-name:
        type: string
jobs:
  build:
    uses: cnighojkar/myworkflows/.github/workflows/build.yml@main
    with:
      java-version: ${{ inputs.java-version }}  
      app-name: ${{ inputs.app-name }}  
    secrets: inherit
  
  # dependency-check:
  #   needs: build
  #   uses: cnighojkar/myworkflows/.github/workflows/dependency-check.yml@main
  #   with:
  #     java-version: ${{ inputs.java-version }}

  # cfn-nag-scan:
  #   uses: cnighojkar/myworkflows/.github/workflows/cfn-nag-scan.yml@main
  #   needs: build

  checkov-scan:
    uses: cnighojkar/myworkflows/.github/workflows/checkov-scan.yml@main
    needs: build

  Ivan-scan:
    uses: cnighojkar/myworkflows/.github/workflows/Ivan-scan.yml@main
    needs: build
    with:
      version: ${{ inputs.version }}  
      app-name: ${{ inputs.app-name }}  
    secrets: inherit
  
  last-step:
    uses: cnighojkar/myworkflows/.github/workflows/last-step.yml@main
    needs: [Ivan-scan, checkov-scan]


    